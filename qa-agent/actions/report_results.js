// actions/report_results.js const fs = require('fs'); const xml2js = require('xml2js'); const path = require('path'); const trx = path.join('reports','TestResult.trx'); if(!fs.existsSync('reports')) fs.mkdirSync('reports',{recursive:true}); async function main(){ if(!fs.existsSync(trx)){ fs.writeFileSync(path.join('reports','qa-report.json'), JSON.stringify({executed:false},null,2)); console.log('No TRX found - wrote executed:false'); return; } const xml = fs.readFileSync(trx,'utf8'); const parser = new xml2js.Parser(); const json = await parser.parseStringPromise(xml); const summary = json.TestRun && json.TestRun.ResultSummary ? json.TestRun.ResultSummary[0] : {}; const out = { summary, generatedAt: new Date().toISOString() }; fs.writeFileSync(path.join('reports','qa-report.json'), JSON.stringify(out,null,2)); console.log('Report written to reports/qa-report.json'); } main();